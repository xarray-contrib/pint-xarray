parameters:
  env_file: ci/requirements/$CONDA_ENV.yml

steps:
- template: add-conda-to-path.yml

- bash: |
    conda update -y conda
    conda env create -n pint-xarray-tests --file ${{ parameters.env_file }}
  displayName: Install conda dependencies

- script: |
    python -m pip install \
      -i https://pypi.anaconda.org/scipy-wheels-nightly/simple \
      --no-deps \
      --pre \
      --upgrade \
      numpy
    python -m pip install --upgrade \
      git+https://github.com/hgrecco/pint \
      git+https://github.com/pydata/xarray
  displayName: Install upstream-dev dependencies
  condition: eq(variables['UPSTREAM_DEV'], 'true')

- bash: |
    source activate pint-xarray-tests
    python -m pip install --no-deps -e .
  displayName: Install pint-xarray

- bash: |
    source activate pint-xarray-tests
    conda info -a
    conda list
  displayName: Version Info